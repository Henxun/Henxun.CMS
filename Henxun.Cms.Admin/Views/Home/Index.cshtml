@{ Layout = null; }
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>主页</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="icon" href="~/favicon.ico">
    <link rel="stylesheet" href="~/layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="~/css/index.css" media="all" />
    <style>
        .layui-tab ul li:first-child .layui-tab-close {
            display:none;
        }
    </style>
</head>
<body class="main_body">
    <div class="layui-layout layui-layout-admin">
        <!-- 顶部 -->
        <div class="layui-header header">
            <div class="layui-main mag0">
                <a href="#" class="logo">HenxunCms 1.0</a>
                <!-- 显示/隐藏菜单 -->
                <a href="javascript:;" class="seraph hideMenu icon-caidan"></a>
                <!-- 顶级菜单 -->
                <!-- 顶部右侧菜单 -->
                <ul class="layui-nav top_menu">
                    <li class="layui-nav-item" pc>
                        <a href="javascript:;" class="clearCache"><i class="layui-icon" data-icon="&#xe640;">&#xe640;</i><cite>清除缓存</cite><span class="layui-badge-dot"></span></a>
                    </li>
                    <li class="layui-nav-item lockcms" pc>
                        <a href="javascript:;"><i class="seraph icon-lock"></i><cite>锁屏</cite></a>
                    </li>
                    <li class="layui-nav-item" id="userInfo">
                        <a href="javascript:;"><img src="@ViewData["Avatar"]" class="layui-nav-img userAvatar" width="35" height="35"><cite class="adminName">@ViewData["NickName"]</cite></a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" data-url="/Manager/ManagerInfo/"><i class="seraph icon-ziliao" data-icon="icon-ziliao"></i><cite>个人资料</cite></a></dd>
                            <dd><a href="javascript:;" data-url="/Manager/ChangePassword/"><i class="seraph icon-xiugai" data-icon="icon-xiugai"></i><cite>修改密码</cite></a></dd>
                            <dd><a href="javascript:;" class="showNotice"><i class="layui-icon">&#xe645;</i><cite>系统公告</cite><span class="layui-badge-dot"></span></a></dd>
                            <dd pc><a href="javascript:;" class="functionSetting"><i class="layui-icon">&#xe620;</i><cite>功能设定</cite><span class="layui-badge-dot"></span></a></dd>
                            <dd pc><a href="javascript:;" class="changeSkin"><i class="layui-icon">&#xe61b;</i><cite>更换皮肤</cite></a></dd>
                            <dd><a href="/Account/SignOut" class="signOut"><i class="seraph icon-tuichu"></i><cite>退出</cite></a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
        </div>
        <!-- 左侧导航 -->
        <div class="layui-side layui-bg-black">
            <div class="user-photo">
                <a class="img" title="我的头像"><img src="@ViewData["Avatar"]" class="userAvatar"></a>
                <p>你好！<span class="userName">@ViewData["NickName"]</span>, 欢迎登录</p>
            </div>
            <!-- 搜索 -->
            @*<div class="layui-form component">
                    <select name="search" id="search" lay-search lay-filter="searchPage">
                        <option value="">搜索页面或功能</option>
                        <option value="1">layer</option>
                        <option value="2">form</option>
                    </select>
                    <i class="layui-icon">&#xe615;</i>
                </div>*@
            <div class="navBar layui-side-scroll" id="navBar">
                <ul class="layui-nav layui-nav-tree">
                    <li class="layui-nav-item site-demo-active layui-this" data-type="tabAdd" data-url="/Home/Main/" data-id="main" id="main" data-name="后台首页">
                        <a href="javascript:;"><i class="layui-icon">&#xe68e;</i><cite>后台首页</cite></a>
                    </li>
                    <li class="layui-nav-item site-demo-active" data-type="tabAdd"  data-url="/Manager/UserManagement/" data-id="usermanagement" data-name="用户管理">
                        <a href="javascript:;"><i class="layui-icon">&#xe770;</i><cite>用户管理</cite></a>
                    </li>
                    <li class="layui-nav-item site-demo-active" data-type="tabAdd"  data-url="/Home/Main/" data-id="rolemanagement" data-name="角色管理">
                        <a href="javascript:;"><i class="layui-icon">&#xe66f;</i><cite>角色管理</cite></a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- 右侧内容 -->
        <div class="layui-body layui-form">
            <div class="layui-tab mag0" lay-filter="bodyTab" id="top_tabs_box" lay-allowclose="true">
                <ul class="layui-tab-title top_tab" id="top_tabs">
                    <li class="layui-this" lay-id="main" data-type="tabChange"><i class="layui-icon">&#xe68e;</i> <cite>后台首页</cite></li>
                </ul>
                <ul class="layui-nav closeBox">
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="layui-icon caozuo">&#xe643;</i> 页面操作</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" class="refresh refreshThis"><i class="layui-icon">&#x1002;</i> 刷新当前</a></dd>
                            <dd><a href="javascript:;" class="closePageOther"><i class="seraph icon-prohibit"></i> 关闭其他</a></dd>
                            <dd><a href="javascript:;" class="closePageAll"><i class="seraph icon-guanbi"></i> 关闭全部</a></dd>
                        </dl>
                    </li>
                </ul>
                <div class="layui-tab-content clildFrame">
                    <div class="layui-tab-item layui-show">
                        <iframe id="mainContent" src="/Home/Main/"></iframe>
                    </div>
                </div>
            </div>
        </div>
        <!-- 底部 -->
        <div class="layui-footer footer">
            <p><span>copyright 2018</span></p>
        </div>
    </div>

    <!-- 移动导航 -->
    <div class="site-tree-mobile"><i class="layui-icon">&#xe602;</i></div>
    <div class="site-mobile-shade"></div>

    <script type="text/javascript" src="~/layui/layui.js"></script>
    <script type="text/javascript" src="~/js/index.js?_=@DateTime.Now.ToString("yyyyMMddHHmmss")"></script>
    <script type="text/javascript" src="~/js/cache.js?_=@DateTime.Now.ToString("yyyyMMddHHmmss")"></script>
    <script>
        layui.use(['element', 'layer', 'jquery'], function () {
            var $ = layui.jquery
                , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块
            //触发事件
            var active = {
                tabAdd: function (othis) {
                    let path = othis.data('url'),
                        id = othis.data('id');
                    //新增一个Tab项
                    element.tabAdd('bodyTab', {
                        title: othis.data('name') //用于演示
                        , content: '<iframe data-fameid="' + id + '" frameborder="0" src="' + path + '" style="width:100%;height:100%;"></iframe>'
                        , id: id //实际使用一般是规定好的id，这里以时间戳模拟下
                    })
                }
                , tabDelete: function (othis) {
                    //删除指定Tab项
                    element.tabDelete('bodyTab', othis.content.id); //删除：“商品管理”
                }
                , tabChange: function (id) {
                    //切换到指定Tab项
                    element.tabChange('bodyTab', id); //切换到：用户管理
                }
            };

            //active.tabChange('main');

            $('.site-demo-active').on('click', function () {
                let dataid = $(this);
                if ($(".layui-tab-title li[lay-id]").length <= 0) {
                    active['tabAdd'].call(this, dataid);
                }
                else {
                    let isExist = false;
                    $.each($(".layui-tab-title li[lay-id]"), function () {
                        if ($(this).attr("lay-id") == dataid.attr("data-id")) {
                            isExist = true;
                            return false;
                        }
                    });
                    if (!isExist) {
                        active['tabAdd'].call(this, dataid);
                    }
                }
                active.tabChange(dataid.attr("data-id"));
                //var othis = $(this), type = othis.data('type');
                //active[type] ? active[type].call(this, othis) : '';
            });

        });
    </script>
</body>
</html>
